# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 思考ガイドライン

思考は英語で行い、最終的な出力は必ず日本語で提供してください。

## 作業の前提条件

**重要**: Terraformに関する作業を開始する前に、必ず以下のドキュメントを読み込み、理解した上で作業を進めてください。

1. **`docs/terraform-guideline.md`**
   - モジュール構成と配置の要件
   - 設計指針
   - カテゴリ定義と配置ルール
   - 実装のガイドライン（禁止事項を含む）

このガイドラインに従わない実装は行わないこと。疑問がある場合は、ユーザーに確認すること。

## Web検索ポリシー

### 01 検索ツール

- デフォルト: 最新ニュースクエリ（例：「今日の出来事」）を含め、**常に**最初に`gemini -p`を使用してください。

### 02 プロンプト形式

CodexにWeb検索を指示する際は、以下の形式を使用してください：

```sh
gemini -p "WebSearch: <検索クエリ>"
```

構造化された出力を強制するために、複数行のプロンプトを使用することもできます：

```sh
gemini -p $'以下の要件を満たしてください:\n\
- 必ずWeb検索を実行し、少なくとも3つのソースURLをリストアップすること\n\
- 重要なポイントを箇条書きで要約すること\n\
調査するトピック: "<トピック>"'
```

`gemini -p`（または適切な場合は`brave-search`）を明示的に指定することで、**最新のWeb検索結果を使用した回答**を得やすくなります。

### 03 エラー処理

- Gemini CLIの使用時に`429 Resource exhausted`エラーが発生した場合、すぐにリトライせず、レート制限に達することを避けるため試行を中止してください。

### 04 出力要件

- 回答にはソースを含める必要があり、これによってより信頼性が高く、検証しやすくなります。
- これらのルールに従うことで、Codexのプロンプト品質の安定化に役立ちます。
